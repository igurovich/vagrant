#!/bin/bash

# Source function library.
. /etc/init.d/functions

. /etc/sysconfig/network

CATALINA_HOME=<%= node['vagrant_tomcat']['tomcat_home']%>

LOCKFILE=/var/lock/subsys/tomcat

RETVAL=0
start() {
	echo "Starting Tomcat:"
	su - $TOMCAT_USER -c "CATALINA_HOME/bin/startup.sh"
	RETVAL=$?
	[ $RETVAL -eq 0] && touch $LOCKFILE
	return $RETVAL
}

stop() {
	echo "Shutting down Tomcat:"
	CATALINA_HOME/bin/shutdown.sh"
	RETVAL=$?
	echo
	[ $RETVAL -eq 0] && rm -f $LOCKFILE
	return $RETVAL
}

case "$1" in
	start)
		start
		;;
	stop)
		stop
		;;
	restrt)
		stop
		start
		;;
	status)
		status tomcat
		;;
esac					